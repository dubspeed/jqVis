<html>
<head>
	<link rel="stylesheet" type="text/css" href="lib/codemirror.css">
	<link rel="stylesheet" type="text/css" href="jqvis.css"></link>
	<script src="lib/codemirror.js"></script>
	<script src="lib/mode/xml/xml.js"></script>
    <script src="lib/mode/javascript/javascript.js"></script>
    <script src="lib/mode/css/css.js"></script>
    <script src="lib/mode/htmlmixed/htmlmixed.js"></script>
	<script src="lib/jquery_1.7.2_dev.js" type="text/javascript" charset="utf-8"></script>
	<script src="src/dub.js" type="text/javascript" charset="utf-8"></script>
	<script src="src/jqvis.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" charset="utf-8">
		$(document).ready(function() {
            var editor = CodeMirror.fromTextArea($("#editor")[0], {
                lineNumbers : true,
                matchBrackets : true
            }),

            vis = Object.create(jqvis),
            
            lastMarker = undefined,
            
            clearMarkers = function() {
                 if (lastMarker) {
                     for (var i=0; i<lastMarker.length; i += 1) {
                         editor.clearMarker(lastMarker[i]);
                     }
                 }             
            },

            setMarkers = function(lines) {
                 lastMarker = lines;
                 for (var i=0; i<lines.length; i += 1) {
                     editor.setMarker(lines[i], "<div class='highlight_line'>%N%</div>"); //, className)
                 }
            },
            
			queryEvent = function(evt) {
			     evt.preventDefault();
			     clearMarkers();
			     vis.setHTML(editor.getValue());
			     vis.query($("#query").val());
			     setMarkers(vis.getLines());
			};

            vis.setMark("<mark>", "</mark>");

			$("#submit").bind("click", queryEvent);
		});
	</script>
</head>
<body>
    <header class="softshadow">
        <h1>JQuery Visualizer</h1>
    </header>

    <section id="querysection">
        <textarea id="query" cols="50">$('');</textarea>
        <div id="submit" class="button">query</div>
    </section>
    
    <div class="rows">
        <div class="section softshadow leftarea">
            <form>
            <textarea id="editor" name="editor">
            
  <html>
  <head>
    <title>Simple</title>
  </head>
  <body>
    <h1>HTML Example</h1>
    <p>This is a nice text paragraph</p>
    <p>Another paragrpah, this time with div insdide
       <div>a div</div> <div> another</div><br/>
       <strong>huhu</strong><br/>
    </p>
    <ul>
    <li>one</li>
    <li>two</li>
    <li>three</li>
    </ul>
  </body>
</html>
    
            
            
            </textarea>
            </form>
        </div>
        <div class="rightarea">
	        <iframe id="render_window" seamless><p>IFrames not supported</p></iframe>
        </div>
    </div>

    <footer>
    </footer>

</body>
</html>